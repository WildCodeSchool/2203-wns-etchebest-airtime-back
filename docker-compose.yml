services: 
    db:
        image: mysql
        command: --default-authentication-plugin=mysql_native_password
        restart: always
        environment: 
            MYSQL_ROOT_PASSWORD: Edknb67100&* 
            MYSQL_DATABASE: airtime
        healthcheck:
            test: ["CMD", "mysqladmin" ,"ping", "-h", "localhost"]
            timeout: 20s
            retries: 10
        volumes: 
            - ./init:/docker-entrypoint-initdb.d
    server:
        depends_on:
          db:
            condition: service_healthy
        build: ./
        restart: unless-stopped
        ports:
          - 4000:4000
        environment:
          - DB_HOST=db
          - DB_USER=root
          - DB_PASSWORD=Edknb67100&*
          - DB_NAME=airtime
          - DB_PORT=3306
        stdin_open: true
        tty: true